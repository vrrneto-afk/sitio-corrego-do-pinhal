<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Administra√ß√£o</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
:root{
  --marrom:#7b3f2a;
  --bege:#f6efe7;
  --verde:#2f6b2f;
  --cinza:#666;
}
*{box-sizing:border-box;font-family:Arial}
body{margin:0;background:var(--bege)}
header{background:var(--marrom);color:#fff;padding:12px;text-align:center}

nav{
  display:flex;
  gap:10px;
  background:#fff;
  padding:10px;
  justify-content:center;
  flex-wrap:wrap;
}
nav button{
  padding:8px 14px;
  border:none;
  cursor:pointer;
  background:#eee;
}
nav button.active{
  background:var(--verde);
  color:#fff;
}

.container{
  max-width:900px;
  margin:20px auto;
  background:#fff;
  padding:15px;
  border-radius:6px;
}
.hidden{display:none}
</style>
</head>

<body>

<header>üîê Administra√ß√£o</header>

<nav>
  <button onclick="irInicio()">IN√çCIO</button>
  <button onclick="abrirAba('animais')">ANIMAIS</button>
  <button onclick="abrirAba('despesas')">DESPESAS</button>
  <button onclick="abrirAba('eventos')">EVENTOS</button>
  <button onclick="abrirAba('vacinas')">VACINAS</button>
  <button onclick="abrirAba('leite')">PRODU√á√ÉO DE LEITE</button>
  <button onclick="abrirAba('config')">CONFIG</button>
</nav>

<!-- ================= LOGIN ================= -->
<div class="container" id="loginBox">
  <h3>Login</h3>
  <input id="email" placeholder="Email"><br><br>
  <input id="senha" type="password" placeholder="Senha"><br><br>
  <button onclick="login()">Entrar</button>
</div>

<!-- ================= APP ================= -->
<div class="container hidden" id="app">

  <!-- ========= ANIMAIS ========= -->
  <div id="aba-animais">
    <!-- üîí C√ìDIGO DE ANIMAIS COLADO AQUI INTEGRALMENTE -->
    <!-- EXATAMENTE O C√ìDIGO QUE VOC√ä TRAVOU -->
    <!-- N√ÉO FOI ALTERADO -->
    <!DOCTYPE html>    <html lang="pt-BR">    
<head>    
<meta charset="UTF-8">    
<meta name="viewport" content="width=device-width, initial-scale=1.0">    
<title>Administra√ß√£o ‚Äì Cadastro de Animais</title>    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>    <style>    
:root{    
  --marrom:#7b3f2a;    
  --bege:#f6i6efe7;    
  --verde:#2f6b2f;    
  --vermelho:#b03a2e;    
}    
*{box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}    
body{margin:0;background:var(--bege)}    
header{background:var(--marrom);color:#fff;padding:14px;text-align:center;font-weight:bold}    
.container{max-width:600px;margin:20px auto;padding:15px;background:#fff;border-radius:6px}    
label{font-weight:bold;margin-top:12px;display:block}    
input,select,textarea{width:100%;padding:10px;margin-top:6px;font-size:15px}    
textarea{resize:vertical}    
button{width:100%;padding:12px;margin-top:15px;font-size:16px;border:none;cursor:pointer}    
.salvar{background:var(--verde);color:#fff}    
.excluir{background:var(--vermelho);color:#fff}    
.sair{background:#666;color:#fff}    
.hidden{display:none}    
</style>    </head>    <body>    <header>üîê Administra√ß√£o ‚Äì Cadastro de Animais</header>    <div class="container" id="loginBox">    
  <label>E-mail</label>    
  <input id="email" type="email">    
  <label>Senha</label>    
  <input id="senha" type="password">    
  <button class="salvar" onclick="login()">Entrar</button>    
</div>    <div class="container hidden" id="app">    <button class="sair" onclick="logout()">üö™ Sair</button>

<label>A√ß√£o</label>
<select id="acao">

  <option value="novo">Cadastrar novo</option>    
  <option value="editar">Editar animal</option>    
</select>    <div id="blocoSelect" class="hidden">    
  <label>Selecione o animal</label>    
  <select id="animalSelect"></select>    
</div>    <label>Nome</label>
<input id="nome">

<label>Esp√©cie</label>
<select id="especie">

  <option>Bovino</option>    
  <option>Equino</option>    
  <option>Caprino</option>    
  <option>Su√≠no</option>    
  <option>Ave - Galinha</option>    
  <option>Ave - Ganso</option>    
  <option>Ave - Marreco</option>    
  <option>Ave - Peru</option>    
  <option>Ave - Angola</option>    
  <option>Ave - Diversos</option>    
  <option>Cachorro</option>    
  <option>Gato</option>    
  <option>Outros</option>    
</select>    <label>Sexo</label>
<select id="sexo">

  <option value="M">Macho</option>    
  <option value="F">F√™mea</option>    
</select>    <label>Ra√ßa</label>
<input id="raca">

<label>Data de nascimento</label>
<input id="nascimento" type="date">

<label>Status</label>
<select id="status">

  <option value="Ativo">Ativo</option>    
  <option value="Inativo">Inativo</option>    
  <option value="Vendido">Vendido</option>    
  <option value="Falecido">Falecido</option>    
</select>    <label>M√£e (opcional)</label>
<select id="mae"></select>

<label>Pai (opcional)</label>
<select id="pai"></select>

<label>Foto (URL)</label>
<input id="foto">

<label>Observa√ß√µes</label>

<textarea id="obs"></textarea>    <button class="salvar" onclick="salvar()">üíæ Salvar</button>
<button class="excluir hidden" id="btnExcluir" onclick="excluir()">üóëÔ∏è Excluir</button>

</div>    <script>    
firebase.initializeApp({    
  apiKey: "AIzaSyCW-CuFDrOLO-dteckl_GrPTocmyS-IrzY",    
  authDomain: "sitio-corrego-do-pinhal.firebaseapp.com",    
  projectId: "sitio-corrego-do-pinhal"    
});    
    
const auth = firebase.auth();    
const db = firebase.firestore();    
auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL);    
    
let animais=[], docAtual=null;    
    
auth.onAuthStateChanged(user=>{    
  if(user){    
    loginBox.classList.add("hidden");    
    app.classList.remove("hidden");    
    carregar();    
  }    
});    
    
function login(){    
  auth.signInWithEmailAndPassword(email.value, senha.value)    
    .catch(e=>alert(e.message));    
}    
    
function logout(){    
  auth.signOut();    
  location.reload();    
}    
    
async function carregar(){    
  const snap = await db.collection("animais").get();    
  animais = snap.docs.map(d=>({id:d.id,...d.data()}));    
    
  animalSelect.innerHTML = `<option value="">Selecione</option>`;    
  mae.innerHTML = `<option value="">---</option>`;    
  pai.innerHTML = `<option value="">---</option>`;    
    
  animais.sort((a,b)=>a.nome.localeCompare(b.nome)).forEach(a=>{    
    animalSelect.innerHTML += `<option value="${a.id}">${a.nome}</option>`;    
    if(a.sexo==="F") mae.innerHTML += `<option value="${a.id}">${a.nome}</option>`;    
    if(a.sexo==="M") pai.innerHTML += `<option value="${a.id}">${a.nome}</option>`;    
  });    
}    
    
acao.onchange=()=>{    
  blocoSelect.classList.toggle("hidden", acao.value==="novo");    
  btnExcluir.classList.toggle("hidden", acao.value==="novo");    
};    
    
animalSelect.onchange=()=>{    
  const a = animais.find(x=>x.id===animalSelect.value);    
  if(!a) return;    
  docAtual=a.id;    
    
  nome.value=a.nome||"";    
  especie.value=a.especie||"";    
  sexo.value=a.sexo||"";    
  raca.value=a.raca||"";    
  nascimento.value=a.data_nascimento||"";    
  status.value=a.status||"Ativo";    
  mae.value=a.id_mae||"";    
  pai.value=a.id_pai||"";    
  foto.value=a.foto||"";    
  obs.value=a.observacoes||"";    
};    
    
async function salvar(){    
  const statusFinal = document.getElementById("status").value;    
    
  const dados={    
    nome:nome.value.trim(),    
    especie:especie.value,    
    sexo:sexo.value,    
    raca:raca.value,    
    data_nascimento:nascimento.value,    
    status:statusFinal,    
    id_mae:mae.value||"",    
    id_pai:pai.value||"",    
    foto:foto.value||"",    
    observacoes:obs.value||""    
  };    
    
  if(acao.value==="novo"){    
    await db.collection("animais").add(dados);    
  }else{    
    await db.collection("animais").doc(docAtual).update(dados);    
  }    
    
  alert("Salvo com sucesso");    
  location.reload();    
}    
    
async function excluir(){    
  if(confirm("Excluir este animal?")){    
    await db.collection("animais").doc(docAtual).delete();    
    alert("Exclu√≠do");    
    location.reload();    
  }    
}    
</script>    </body>    
    </html>
  </div>

  <!-- ========= DESPESAS ========= -->
  <div id="aba-despesas" class="hidden">
    <h3>üí∞ Despesas</h3>
    <p>Cadastro de despesas (valor_total calculado automaticamente)</p>
  </div>

  <!-- ========= EVENTOS ========= -->
  <div id="aba-eventos" class="hidden">
    <h3>üìÖ Eventos</h3>
  </div>

  <!-- ========= VACINAS ========= -->
  <div id="aba-vacinas" class="hidden">
    <h3>üíâ Vacinas</h3>
  </div>

  <!-- ========= LEITE ========= -->
  <div id="aba-leite" class="hidden">
    <h3>ü•õ Produ√ß√£o de Leite</h3>
  </div>

  <!-- ========= CONFIG ========= -->
  <div id="aba-config" class="hidden">
    <h3>‚öôÔ∏è Configura√ß√µes</h3>
  </div>

</div>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyCW-CuFDrOLO-dteckl_GrPTocmyS-IrzY",
  authDomain: "sitio-corrego-do-pinhal.firebaseapp.com",
  projectId: "sitio-corrego-do-pinhal"
});

const auth=firebase.auth();
auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL);

auth.onAuthStateChanged(u=>{
  if(u){
    loginBox.classList.add("hidden");
    app.classList.remove("hidden");
  }
});

function login(){
  auth.signInWithEmailAndPassword(email.value,senha.value)
    .catch(e=>alert(e.message));
}

function irInicio(){
  window.location.href="index.html";
}

function abrirAba(nome){
  document.querySelectorAll('[id^="aba-"]').forEach(d=>d.classList.add("hidden"));
  document.getElementById("aba-"+nome).classList.remove("hidden");
}
</script>

</body>
</html>
