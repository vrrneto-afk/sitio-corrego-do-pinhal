<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>S√≠tio C√≥rrego do Pinhal ‚Äî In√≠cio</title>

  <style>
    :root{
      --bg:#f3efe8;
      --card:#ffffff;
      --primary:#6b4e2e;
      --warn:#c0392b;
      --ok:#2e7d32;
      --soft:#f7efe3;
      --text:#333;
      --muted:#666;
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:var(--bg);
      color:var(--text);
    }

    /* HEADER */
    header{
      background:#fff;
      padding:10px 14px;
      display:flex;
      align-items:center;
      gap:12px;
      border-bottom:1px solid #e5e0d8;
      position:sticky;
      top:0;
      z-index:10;
    }

    .logo{
      height:42px;
      width:auto;
    }

    .title{
      font-size:18px;
      font-weight:600;
      color:var(--primary);
    }

    /* BLOCO */
    .bloco{
      background:var(--soft);
      border-radius:14px;
      padding:12px;
      margin:12px;
    }

    .bloco h2{
      margin:0 0 10px 0;
      font-size:18px;
      color:#3f2e1b;
    }

    /* CARD */
    .card{
      background:var(--card);
      border-radius:12px;
      padding:10px;
      margin-bottom:10px;
      border-left:6px solid #c9a24d;
    }

    .card.atrasada{ border-left-color:var(--warn); }
    .card.ok{ border-left-color:var(--ok); }

    .nome{
      font-weight:700;
      font-size:16px;
      margin-bottom:4px;
    }

    .linha{
      font-size:14px;
      color:var(--muted);
      line-height:1.4;
    }

    .vazio{
      font-size:14px;
      color:var(--muted);
      padding:6px 2px;
    }
  </style>
</head>
<body>

  <!-- TOPO -->
  <header>
    <img src="./logo.png" alt="S√≠tio C√≥rrego do Pinhal" class="logo">
    <div class="title">In√≠cio</div>
  </header>

  <!-- VACAS A CRIAR -->
  <section class="bloco">
    <h2>üêÑ Vacas a Criar</h2>
    <div id="lista-vacas"></div>
  </section>

  <!-- VACINAS -->
  <section class="bloco">
    <h2>üíâ Vacinas</h2>
    <div id="lista-vacinas"></div>
  </section>

  <script>
    /* ======================
       DADOS DE TESTE (MOCK)
       ====================== */

    const animais = [
      { id_animal:"A003", nome:"Boneca", sexo:"F", especie:"Bovino", status:"Ativo" },
      { id_animal:"A005", nome:"Cachoeira", sexo:"F", especie:"Bovino", status:"Ativo" }
    ];

    const eventos = [
      { tipo_evento:"cobertura", id_animal:"A003", data_evento:"2025-04-18" },
      { tipo_evento:"cobertura", id_animal:"A005", data_evento:"2025-07-31" }
    ];

    const vacinas = [
      {
        nome_animal:"Cachoeira",
        vacina_aplicada:"Treo",
        data_aplicacao:"2025-10-01",
        repeticao_dias:90
      }
    ];

    /* ======================
       FUN√á√ïES AUXILIARES
       ====================== */

    function formatarData(d){
      return new Date(d).toLocaleDateString("pt-BR");
    }

    /* ======================
       VACAS A CRIAR
       ====================== */

    function getVacasACriar(animais, eventos){
      const hoje = new Date();

      return animais
        .filter(a => a.sexo==="F" && a.especie==="Bovino" && a.status==="Ativo")
        .map(vaca=>{
          const cob = eventos
            .filter(e => e.tipo_evento==="cobertura" && e.id_animal===vaca.id_animal)
            .sort((a,b)=> new Date(b.data_evento)-new Date(a.data_evento))[0];

          if(!cob) return null;

          const dataCob = new Date(cob.data_evento);
          const dataPrev = new Date(dataCob);
          dataPrev.setMonth(dataPrev.getMonth()+9);

          const dias = Math.ceil((dataPrev-hoje)/(1000*60*60*24));

          return { nome:vaca.nome, dataCob, dataPrev, dias };
        })
        .filter(Boolean)
        .sort((a,b)=>a.dataPrev-b.dataPrev);
    }

    function renderVacas(){
      const el = document.getElementById("lista-vacas");
      el.innerHTML="";
      const lista = getVacasACriar(animais,eventos);

      if(!lista.length){
        el.innerHTML = `<div class="vazio">‚úÖ Nenhuma vaca a criar</div>`;
        return;
      }

      lista.forEach(v=>{
        el.innerHTML += `
          <div class="card ${v.dias<0?"atrasada":"ok"}">
            <div class="nome">üêÑ ${v.nome}</div>
            <div class="linha">Cobertura: ${formatarData(v.dataCob)}</div>
            <div class="linha">Previs√£o: ${formatarData(v.dataPrev)}</div>
            <div class="linha">
              ${v.dias<0
                ? `üî¥ Atrasada em ${Math.abs(v.dias)} dias`
                : `‚è≥ Faltam ${v.dias} dias`}
            </div>
          </div>`;
      });
    }

    /* ======================
       VACINAS
       ====================== */

    function getVacinas(vacinas, aviso=30){
      const hoje = new Date();

      return vacinas.map(v=>{
        const prox = new Date(v.data_aplicacao);
        prox.setDate(prox.getDate()+Number(v.repeticao_dias));
        const dias = Math.ceil((prox-hoje)/(1000*60*60*24));
        return {...v, prox, dias};
      }).filter(v=>v.dias<=aviso)
        .sort((a,b)=>a.prox-b.prox);
    }

    function renderVacinas(){
      const el = document.getElementById("lista-vacinas");
      el.innerHTML="";
      const lista = getVacinas(vacinas);

      if(!lista.length){
        el.innerHTML = `<div class="vazio">‚úÖ Nenhuma vacina pendente</div>`;
        return;
      }

      lista.forEach(v=>{
        el.innerHTML += `
          <div class="card ${v.dias<0?"atrasada":"ok"}">
            <div class="nome">üíâ ${v.vacina_aplicada}</div>
            <div class="linha">üêÑ ${v.nome_animal}</div>
            <div class="linha">
              ${v.dias<0
                ? `üî¥ Atrasada em ${Math.abs(v.dias)} dias`
                : `‚è≥ Reaplicar em ${v.dias} dias`}
            </div>
            <div class="linha">üìÖ ${formatarData(v.prox)}</div>
          </div>`;
      });
    }

    /* INIT */
    renderVacas();
    renderVacinas();
  </script>
</body>
</html>
