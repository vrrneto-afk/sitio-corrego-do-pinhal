<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>SÃ­tio â€“ Controle</title>

<style>
  body {
    margin: 0;
    background: #f6efe7;
    font-family: Arial, Helvetica, sans-serif;
    color: #333;
  }

  /* MENU */
  #menu {
    display: flex;
    justify-content: space-around;
    background: #7b3f2a;
    padding: 14px 0;
  }

  #menu button {
    background: none;
    border: none;
    color: #fff;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
  }

  #menu button:hover {
    text-decoration: underline;
  }

  /* CONTEÃšDO */
  .container {
    padding: 20px;
    max-width: 900px;
    margin: auto;
  }

  h2 {
    font-size: 26px;
    color: #7b3f2a;
    margin-bottom: 15px;
  }

  /* CARD */
  .card {
    background: #fff;
    border-radius: 12px;
    padding: 18px;
    margin-bottom: 16px;
    border-left: 8px solid #2f6b2f;
    box-shadow: 0 3px 8px rgba(0,0,0,0.08);
  }

  .card strong {
    font-size: 20px;
    display: block;
    margin-bottom: 6px;
  }

  .card p {
    font-size: 16px;
    margin: 4px 0;
  }

  .alerta {
    font-weight: bold;
    font-size: 17px;
  }

  /* TELAS */
  .tela {
    display: none;
  }

  .tela.ativa {
    display: block;
  }
</style>
</head>

<body>

<!-- MENU -->
<div id="menu">
  <button onclick="mostrar('inicio')">InÃ­cio</button>
  <button onclick="mostrar('vacas')">Vacas</button>
  <button onclick="mostrar('vacinas')">Vacinas</button>
  <button onclick="mostrar('animais')">Animais</button>
</div>

<!-- CONTEÃšDO -->
<div class="container">

  <div id="inicio" class="tela ativa">
    <h2>ğŸ„ Vacas a Criar</h2>
    <div id="inicio-vacas"></div>

    <h2>ğŸ’‰ Vacinas</h2>
    <div id="inicio-vacinas"></div>
  </div>

  <div id="vacas" class="tela">
    <h2>ğŸ„ Vacas a Criar</h2>
    <div id="lista-vacas"></div>
  </div>

  <div id="vacinas" class="tela">
    <h2>ğŸ’‰ Vacinas</h2>
    <div id="lista-vacinas"></div>
  </div>

  <div id="animais" class="tela">
    <h2>ğŸ® Animais</h2>
    <div id="lista-animais"></div>
  </div>

</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxizkZt7pvNE-otYQe0sqtjYBUx3iI8QA13Di6Cv4hq2YgaosafGzYx2XBf71CxK0QzfQ/exec";

function mostrar(tela) {
  document.querySelectorAll(".tela").forEach(t => t.classList.remove("ativa"));
  document.getElementById(tela).classList.add("ativa");
}

fetch(API_URL)
  .then(res => res.json())
  .then(dados => {
    carregarVacas(dados);
    carregarVacinas(dados);
    carregarAnimais(dados);
  });

function carregarVacas(dados) {
  const eventos = dados.EVENTOS.slice(1);
  const animais = dados.ANIMAIS.slice(1);

  const coberturas = eventos.filter(e => e[1] === "cobertura");

  coberturas.forEach(c => {
    const animal = animais.find(a => a[0] === c[3]);
    if (!animal) return;

    const cobertura = new Date(c[2]);
    const previsao = new Date(cobertura);
    previsao.setDate(previsao.getDate() + 280);

    const dias = Math.ceil((previsao - new Date()) / 86400000);

    const card = `
      <div class="card">
        <strong>${animal[1]}</strong>
        <p>Cobertura: ${cobertura.toLocaleDateString()}</p>
        <p>PrevisÃ£o: ${previsao.toLocaleDateString()}</p>
        <p class="alerta">â³ Faltam ${dias} dias</p>
      </div>
    `;

    document.getElementById("inicio-vacas").innerHTML += card;
    document.getElementById("lista-vacas").innerHTML += card;
  });
}

function carregarVacinas(dados) {
  const vacinas = dados.VACINAS.slice(1);

  vacinas.forEach(v => {
    const prox = new Date(v[7]);
    const dias = Math.ceil((prox - new Date()) / 86400000);

    const texto = dias >= 0
      ? `â° Reaplicar em ${dias} dias`
      : `âš ï¸ Atrasada em ${Math.abs(dias)} dias`;

    const card = `
      <div class="card">
        <strong>${v[4]}</strong>
        <p>ğŸ„ ${v[2]}</p>
        <p class="alerta">${texto}</p>
        <p>ğŸ“… ${prox.toLocaleDateString()}</p>
      </div>
    `;

    document.getElementById("inicio-vacinas").innerHTML += card;
    document.getElementById("lista-vacinas").innerHTML += card;
  });
}

function carregarAnimais(dados) {
  const animais = dados.ANIMAIS.slice(1).filter(a => a[9] === "Ativo");

  animais.forEach(a => {
    document.getElementById("lista-animais").innerHTML += `
      <div class="card">
        <strong>${a[1]}</strong>
        <p>${a[2]} â€¢ ${a[4]} â€¢ ${a[3]}</p>
      </div>
    `;
  });
}
</script>

</body>
</html>
